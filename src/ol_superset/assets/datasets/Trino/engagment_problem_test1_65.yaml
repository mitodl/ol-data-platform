table_name: engagment_problem_test1
main_dttm_col: null
description: null
default_endpoint: null
offset: 0
cache_timeout: null
catalog: ol_data_lake_production
schema: ol_warehouse_production_dimensional
sql: "with g as (\nselect \nproblem_block_fk\n, courserun_readable_id\n, openedx_user_id\n\
  , max(cast(max_grade as decimal(30,10))) max_possible_grade\n, min(cast(grade as\
  \ decimal(30,10))) learner_lowest_grade\n, max(cast(grade as decimal(30,10))) learner_highest_grade\n\
  from ol_warehouse_production_dimensional.tfact_problem_events \ngroup by \nproblem_block_fk\n\
  , courserun_readable_id\n, openedx_user_id  \n)\n\n, i as (\nselect chapter_block_fk,\
  \ count(distinct problem_block_fk) as number_of_problems\nfrom ol_warehouse_production_dimensional.afact_problem_engagement\n\
  group by chapter_block_fk\n)\n\n\nselect b.platform\n, coalesce(u.email, ou.email)\
  \ as user_email\n, coalesce(u.full_name, ou.full_name) as full_name\n, b.courserun_readable_id\n\
  , h.course_title\n, d.block_title as section_title\n, d.block_index as section_block_index\n\
  , c.block_title as subsection_title\n, c.block_index as subsection_block_index\n\
  , f.block_title as problem_title\n, max(b.num_of_attempts) as num_of_attempts\n\
  , max(b.num_of_correct_attempts) as num_of_correct_attempts\n, max(g.max_possible_grade)\
  \ as max_possible_grade\n, min(g.learner_lowest_grade) as learner_lowest_grade\n\
  , max(g.learner_highest_grade) as learner_highest_grade\n, max(case when b.num_of_correct_attempts>\
  \ 0 then 1 else 0 end) as correct_true_cnt\n, max(case when b.num_of_correct_attempts>\
  \ 0 then 1 else 0 end) as attepted_true_cnt\n, max(i.number_of_problems) as number_of_problems\n\
  from ol_warehouse_production_dimensional.afact_problem_engagement b\nleft join ol_warehouse_production_dimensional.dim_user\
  \ as u\n  on \n    b.platform = 'mitxonline' \n    and b.openedx_user_id = u.mitxonline_openedx_user_id\n\
  left join ol_warehouse_production_dimensional.dim_user as ou\n  on \n    b.platform\
  \ = 'edxorg' \n    and b.openedx_user_id = ou.edxorg_openedx_user_id\ninner join\
  \ ol_warehouse_production_dimensional.dim_course_content c\non b.sequential_block_fk\
  \ =c.block_id\nand c.is_latest = true\ninner join ol_warehouse_production_dimensional.dim_course_content\
  \ d\non b.chapter_block_fk =d.block_id\nand d.is_latest = true\ninner join ol_warehouse_production_dimensional.dim_course_content\
  \ f\non b.problem_block_fk =f.block_id\nand f.is_latest = true\ninner join g\non\
  \ b.problem_block_fk=g.problem_block_fk\nand b.courserun_readable_id=g.courserun_readable_id\n\
  and b.openedx_user_id=g.openedx_user_id\nleft join ol_warehouse_production_intermediate.int__combined__course_runs\
  \ h\n    on b.courserun_readable_id = h.courserun_readable_id\nleft join i\non b.chapter_block_fk\
  \ = i.chapter_block_fk\ngroup by 1, 2, 3, 4, 5, 6, 7, 8, 9, 10\n\n\n"
params: null
template_params: null
filter_select_enabled: true
fetch_values_predicate: null
extra: null
normalize_columns: false
always_filter_main_dttm: false
folders: null
uuid: b9e94ba2-f399-4210-b042-b8aaa4039f58
metrics:
- metric_name: count
  verbose_name: COUNT(*)
  metric_type: count
  expression: COUNT(*)
  description: null
  d3format: null
  currency: null
  extra:
    warning_markdown: ''
  warning_text: null
columns:
- column_name: max_possible_grade
  verbose_name: null
  is_dttm: false
  is_active: true
  type: DECIMAL(30, 10)
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: {}
- column_name: learner_highest_grade
  verbose_name: null
  is_dttm: false
  is_active: true
  type: DECIMAL(30, 10)
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: {}
- column_name: learner_lowest_grade
  verbose_name: null
  is_dttm: false
  is_active: true
  type: DECIMAL(30, 10)
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: {}
- column_name: courserun_readable_id
  verbose_name: null
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: {}
- column_name: user_email
  verbose_name: null
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: {}
- column_name: full_name
  verbose_name: null
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: {}
- column_name: subsection_title
  verbose_name: null
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: {}
- column_name: problem_title
  verbose_name: null
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: {}
- column_name: section_title
  verbose_name: null
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: {}
- column_name: course_title
  verbose_name: null
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: {}
- column_name: platform
  verbose_name: null
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: {}
- column_name: num_of_correct_attempts
  verbose_name: null
  is_dttm: false
  is_active: true
  type: BIGINT
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: {}
- column_name: subsection_block_index
  verbose_name: null
  is_dttm: false
  is_active: true
  type: BIGINT
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: {}
- column_name: number_of_problems
  verbose_name: null
  is_dttm: false
  is_active: true
  type: BIGINT
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: {}
- column_name: section_block_index
  verbose_name: null
  is_dttm: false
  is_active: true
  type: BIGINT
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: {}
- column_name: attepted_true_cnt
  verbose_name: null
  is_dttm: false
  is_active: true
  type: INTEGER
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: {}
- column_name: num_of_attempts
  verbose_name: null
  is_dttm: false
  is_active: true
  type: INTEGER
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: {}
- column_name: correct_true_cnt
  verbose_name: null
  is_dttm: false
  is_active: true
  type: INTEGER
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: {}
version: 1.0.0
database_uuid: 9a22a54c-8b2f-4c66-a866-3f23812ec929
