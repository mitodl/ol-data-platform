table_name: Enrollment_Activity_Counts_Dataset
main_dttm_col: activity_date
description: Auto refreshed at 2026-02-02T16:21:43.979523+00:00
default_endpoint: null
offset: 0
cache_timeout: null
catalog: ol_data_lake_production
schema: ol_warehouse_production_mart
sql: "select c.user_email\n , c.user_gender\n , c.user_country_code\n , c.user_highest_education\n\
  \ , c.courserun_is_current\n , c.platform\n , c.course_readable_id\n , c.courserun_readable_id\n\
  \ , c.activity_date\n , sum(c.certificate_count) as certificate_count\n  , sum(c.enrollment_count)\
  \ as enrollment_count\n  , sum(c.unenrolled_count) as unenrolled_count\n   , sum(c.audit_count)\
  \ as audit_count\n    , sum(c.verified_count) as verified_count\nFROM\n(SELECT enroll_dtl.user_email\n\
  \ , enroll_dtl.user_gender\n , enroll_dtl.user_country_code\n , enroll_dtl.user_highest_education\n\
  \ , enroll_dtl.courserun_is_current\n , enroll_dtl.platform\n , enroll_dtl.course_readable_id\n\
  \ , enroll_dtl.courserun_readable_id\n , substring(courserunenrollment_created_on,\
  \ 1, 10) as activity_date\n , 0 as certificate_count\n, case when courserunenrollment_enrollment_status\
  \ = 'unenrolled' THEN 0 ELSE 1 END as enrollment_count\n, case when courserunenrollment_enrollment_status\
  \ = 'unenrolled' THEN 1 ELSE 0 END as unenrolled_count\n, max(CASE WHEN courserunenrollment_enrollment_mode=\
  \ 'audit' \n  and (courserunenrollment_enrollment_status is null \n      or courserunenrollment_enrollment_status\
  \ <> 'unenrolled')\n  THEN 1 ELSE 0 END) as audit_count\n, 0 as verified_count\n\
  \ FROM ol_warehouse_production_mart.marts__combined_course_enrollment_detail as\
  \ enroll_dtl\ngroup by 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12\n\n\nunion \nSELECT\
  \  \nen_dtl.user_email\n , en_dtl.user_gender\n , en_dtl.user_country_code\n , en_dtl.user_highest_education\n\
  \ , en_dtl.courserun_is_current\n , en_dtl.platform\n , en_dtl.course_readable_id\n\
  \ , en_dtl.courserun_readable_id\n, substring(courseruncertificate_created_on, 1,\
  \ 10) as activity_date\n, MAX(CASE WHEN courseruncertificate_created_on is not null\
  \ then 1 else 0 end)  as certificate_count\n, 0 as enrollment_count\n, 0 as unenrolled_count\n\
  , 0 as audit_count\n, 0 as verified_count\n FROM ol_warehouse_production_mart.marts__combined_course_enrollment_detail\
  \ as en_dtl\nwhere courseruncertificate_created_on is not null\nand (courserunenrollment_enrollment_status\
  \ is null \n      or courserunenrollment_enrollment_status <> 'unenrolled')\ngroup\
  \ by 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13\n\nunion \n\nSELECT a.user_email\n ,\
  \ a.user_gender\n , a.user_country_code\n , a.user_highest_education\n , a.courserun_is_current\n\
  \ , a.platform\n , a.course_readable_id\n , a.courserun_readable_id\n, SUBSTRING(COALESCE(receipt_payment_timestamp\n\
  , order_created_on, courserunenrollment_created_on), 1, 10) as activity_date\n,\
  \ 0 as certificate_count\n, 0 as enrollment_count\n, 0 as unenrolled_count\n, 0\
  \ as audit_count\n, 1 as verified_count\nfrom ol_warehouse_production_mart.marts__combined_course_enrollment_detail\
  \ a\nleft join ol_warehouse_production_mart.marts__combined__orders b\non a.order_id=b.order_Id\n\
  and a.line_id=b.line_id\nand a.platform=b.platform\nwhere a.courserunenrollment_enrollment_mode=\
  \ 'verified'\nand (courserunenrollment_enrollment_status is null \n      or courserunenrollment_enrollment_status\
  \ <> 'unenrolled')\ngroup by 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14) c\n\
  group by 1, 2, 3, 4, 5, 6, 7, 8, 9"
params: null
template_params: null
filter_select_enabled: true
fetch_values_predicate: null
extra: null
normalize_columns: false
always_filter_main_dttm: false
folders: null
uuid: a9301703-0ac1-4eb7-a409-f65da5d8cba1
metrics:
- metric_name: count
  verbose_name: COUNT(*)
  metric_type: count
  expression: COUNT(*)
  description: null
  d3format: null
  currency: null
  extra: {}
  warning_text: null
columns:
- column_name: courserun_readable_id
  verbose_name: null
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: ''
  description: null
  python_date_format: null
  extra: {}
- column_name: course_readable_id
  verbose_name: null
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: ''
  description: null
  python_date_format: null
  extra: {}
- column_name: user_highest_education
  verbose_name: null
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: ''
  description: null
  python_date_format: null
  extra: {}
- column_name: user_country_code
  verbose_name: null
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: ''
  description: null
  python_date_format: null
  extra: {}
- column_name: user_email
  verbose_name: null
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: ''
  description: null
  python_date_format: null
  extra: {}
- column_name: user_gender
  verbose_name: null
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: ''
  description: null
  python_date_format: null
  extra: {}
- column_name: platform
  verbose_name: null
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: ''
  description: null
  python_date_format: null
  extra: {}
- column_name: activity_date
  verbose_name: null
  is_dttm: true
  is_active: true
  type: VARCHAR
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: ''
  description: null
  python_date_format: null
  extra: {}
- column_name: courserun_is_current
  verbose_name: null
  is_dttm: false
  is_active: true
  type: BOOLEAN
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: ''
  description: null
  python_date_format: null
  extra: {}
- column_name: certificate_count
  verbose_name: null
  is_dttm: false
  is_active: true
  type: BIGINT
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: ''
  description: null
  python_date_format: null
  extra: {}
- column_name: audit_count
  verbose_name: null
  is_dttm: false
  is_active: true
  type: BIGINT
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: ''
  description: null
  python_date_format: null
  extra: {}
- column_name: verified_count
  verbose_name: null
  is_dttm: false
  is_active: true
  type: BIGINT
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: ''
  description: null
  python_date_format: null
  extra: {}
- column_name: unenrolled_count
  verbose_name: null
  is_dttm: false
  is_active: true
  type: BIGINT
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: ''
  description: null
  python_date_format: null
  extra: {}
- column_name: enrollment_count
  verbose_name: null
  is_dttm: false
  is_active: true
  type: BIGINT
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: ''
  description: null
  python_date_format: null
  extra: {}
version: 1.0.0
database_uuid: 9a22a54c-8b2f-4c66-a866-3f23812ec929
