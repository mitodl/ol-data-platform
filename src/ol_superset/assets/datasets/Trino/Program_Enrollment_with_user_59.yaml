---
table_name: Program_Enrollment_with_user
main_dttm_col:
description:
default_endpoint:
offset: 0
cache_timeout:
catalog: ol_data_lake_production
schema: ol_warehouse_production_mart
sql: "select enrollment_detail.* \n, coalesce(combined_users.user_highest_education,\
  \ combined_users2.user_highest_education) as user_highest_education\n, coalesce(combined_users.user_industry,\
  \ combined_users2.user_industry) as user_industry\n, coalesce(combined_users.user_company,\
  \ combined_users2.user_company) as user_company\n, coalesce(combined_users.user_job_title,\
  \ combined_users2.user_job_title) as user_job_title\n, coalesce(combined_users.user_birth_year,\
  \ combined_users2.user_birth_year) as user_birth_year\n, coalesce(combined_users.user_gender,\
  \ combined_users2.user_gender) as user_gender\n, coalesce(combined_users.user_address_country,\
  \ combined_users2.user_address_country) as user_address_country\n, courses_detail.courses_taken_in_program\n\
  , combined_users.user_street_address\n, combined_users.user_address_city\n, combined_users.user_address_state_or_territory\n\
  , combined_users.user_address_postal_code\n, case when courses_detail.capstone_sum\
  \ > 0 then 'Y' else 'N' end\n    as capstone_ind\n, date_diff(\n        'day'\n\
  \        , courses_detail.first_courserun_start_on_date\n        , cast(substring(enrollment_detail.programcertificate_created_on,\
  \ 1, 10) as date)\n) as program_complete_days\nfrom \nol_warehouse_production_mart.marts__combined_program_enrollment_detail\
  \ as enrollment_detail\nleft join ol_warehouse_production_mart.marts__combined__users\
  \ as combined_users\non enrollment_detail.platform_name= 'edX.org' and enrollment_detail.user_id=combined_users.user_edxorg_id\n\
  left join ol_warehouse_production_mart.marts__combined__users as combined_users2\n\
  on enrollment_detail.user_hashed_id = combined_users2.user_hashed_id\nleft join\
  \ (select program_name, \nuser_email,\ncount(distinct b.course_readable_id) as courses_taken_in_program,\n\
  sum(case when upper(a.course_title) like '%CAPSTONE%' then 1 else 0 end)\n     \
  \   as capstone_sum\n, min(cast(substring(b.courserun_start_on, 1, 10) as date))\n\
  \        as first_courserun_start_on_date\nfrom ol_warehouse_production_mart.marts__combined_coursesinprogram\
  \ a\ninner join ol_warehouse_production_mart.marts__combined_course_enrollment_detail\
  \ b\non a.course_readable_id=b.course_readable_id\nwhere b.courserunenrollment_enrollment_mode=\
  \ 'verified'\ngroup by 1, 2\n ) as courses_detail\non enrollment_detail.program_name=courses_detail.program_name\n\
  and enrollment_detail.user_email=courses_detail.user_email\n\n\n\n"
params:
template_params:
filter_select_enabled: true
fetch_values_predicate:
extra:
normalize_columns: false
always_filter_main_dttm: false
folders:
uuid: cc496da8-03f6-43ea-9b6c-900ba695e4b6
metrics:
- metric_name: count
  verbose_name: COUNT(*)
  metric_type: count
  expression: COUNT(*)
  description:
  d3format:
  currency:
  extra:
    warning_markdown: ''
  warning_text:
columns:
- column_name: capstone_ind
  verbose_name:
  is_dttm: false
  is_active: true
  type: VARCHAR(1)
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: user_address_state_or_territory
  verbose_name:
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: user_address_postal_code
  verbose_name:
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: program_readable_id
  verbose_name:
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: programcertificate_created_on
  verbose_name:
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: programenrollment_created_on
  verbose_name:
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: programenrollment_enrollment_status
  verbose_name:
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: user_address_city
  verbose_name:
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: user_address_country
  verbose_name:
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: user_highest_education
  verbose_name:
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: user_street_address
  verbose_name:
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: user_hashed_id
  verbose_name:
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: user_full_name
  verbose_name:
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: user_job_title
  verbose_name:
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: programcertificate_uuid
  verbose_name:
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: capstone_indicator
  verbose_name:
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: programcertificate_url
  verbose_name:
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: program_track
  verbose_name:
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: platform_name
  verbose_name:
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: program_name
  verbose_name:
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: user_company
  verbose_name:
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: user_username
  verbose_name:
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: user_email
  verbose_name:
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: program_title
  verbose_name:
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: program_type
  verbose_name:
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: user_gender
  verbose_name:
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: user_industry
  verbose_name:
  is_dttm: false
  is_active: true
  type: VARCHAR
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: user_has_completed_program
  verbose_name:
  is_dttm: false
  is_active: true
  type: BOOLEAN
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: programcertificate_is_revoked
  verbose_name:
  is_dttm: false
  is_active: true
  type: BOOLEAN
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: programenrollment_is_active
  verbose_name:
  is_dttm: false
  is_active: true
  type: BOOLEAN
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: program_is_live
  verbose_name:
  is_dttm: false
  is_active: true
  type: BOOLEAN
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: unique_courses_taken_in_program
  verbose_name:
  is_dttm: false
  is_active: true
  type: BIGINT
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: courses_taken_in_program
  verbose_name:
  is_dttm: false
  is_active: true
  type: BIGINT
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: program_complete_days
  verbose_name:
  is_dttm: false
  is_active: true
  type: BIGINT
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: program_completion_days
  verbose_name:
  is_dttm: false
  is_active: true
  type: BIGINT
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: user_birth_year
  verbose_name:
  is_dttm: false
  is_active: true
  type: BIGINT
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: program_id
  verbose_name:
  is_dttm: false
  is_active: true
  type: BIGINT
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
- column_name: user_id
  verbose_name:
  is_dttm: false
  is_active: true
  type: BIGINT
  advanced_data_type:
  groupby: true
  filterable: true
  expression:
  description:
  python_date_format:
  extra: {}
version: 1.0.0
database_uuid: 8702691f-d666-4dac-943b-9382c02233e3
