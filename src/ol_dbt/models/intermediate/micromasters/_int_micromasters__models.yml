---
version: 2

models:
- name: int__micromasters__course_enrollments
  description: MicroMasters enrollments
  columns:
  - name: program_title
    description: str, title of micromasters program the course is part of
    tests:
    - not_null
  - name: user_id
    description: str, either the edx.org or the mitxonline id for the user
    tests:
    - not_null
  - name: user_username
    description: str, either the edxorg or the mitxonline username for the user
    tests:
    - not_null
  - name: user_country
    description: str, country code for the user's address
  - name: user_email
    description: str, user email
    tests:
    - not_null
  - name: courserun_readable_id
    description: str, course ID on edx.org or openedx
    tests:
    - not_null
  - name: platform
    description: str, the platform of the course. Either 'MITx Online' or 'edX.org'
    tests:
    - not_null
  - name: courserunenrollment_created_on
    description: timestamp, timestamp of user's enrollment in the course
  - name: courserunenrollment_is_active
    description: boolean, whether the enrollment is active
    tests:
    - not_null
  - name: courserun_title
    description: str, title of the course
    tests:
    - not_null
  tests:
  - dbt_expectations.expect_compound_columns_to_be_unique:
      column_list: ["user_id", "platform", "courserun_readable_id"]

- name: int__micromasters__programs
  description: Intermediate model for programs in MicroMasters
  columns:
  - name: program_id
    description: int, sequential ID representing a program in MicroMasters
    tests:
    - not_null
    - unique
  - name: program_title
    description: str, title of the program
    tests:
    - not_null
  - name: program_description
    description: str, description of the program
  - name: program_num_required_courses
    description: int, indicating the number of required courses to earn certificate
    tests:
    - not_null
  - name: program_is_live
    description: boolean, indicating whether program is available to users on MicroMasters
      website
    tests:
    - not_null
  tests:
  - dbt_expectations.expect_table_row_count_to_equal_other_table:
      compare_model: ref('stg__micromasters__app__postgres__courses_program')
- name: int__micromasters__program_requirements
  description: Intermediate model for program requirements in MicroMasters
  columns:
  - name: program_id
    description: int, foreign key to courses_program
    tests:
    - relationships:
        to: ref('stg__micromasters__app__postgres__courses_program')
        field: program_id
  - name: course_id
    description: int, foreign key to courses_course
    tests:
    - relationships:
        to: ref('stg__micromasters__app__postgres__courses_course')
        field: course_id
  - name: electiveset_id
    description: int, sequential ID representing a elective requirement set for a
      program in MicroMasters
  - name: electiveset_required_number
    description: int, indicating the number of required from elective courses
  - name: programrequirement_type
    description: str, indicating the courses is either core or elective
    tests:
    - not_null
    - accepted_values:
        values: ["Core", "Elective"]
  - name: program_num_required_courses
    description: int, indicating the number of required courses to earn certificate
    tests:
    - not_null
- name: int__micromasters__program_certificates
  description: MicroMasters program certificate earners
  columns:
  - name: user_edxorg_username
    description: str, The username of the learner on the edX platform
    tests:
    - not_null
  - name: user_email
    description: str, The email address of the learner on the edX platform
    tests:
    - not_null
  - name: program_title
    description: str, title of the program
    tests:
    - not_null
  - name: user_edxorg_id
    description: int, Numerical user ID of a learner on the edX platform
  - name: program_completion_timestamp
    description: timestamp, timestamp of the course certificate that completed the
      program
  - name: user_gender
    description: str, user's gender from edxorg - blank means user did not specify
      a gender. Null means this student signed up before this information was collected
    tests:
    - accepted_values:
        values: ['Male', 'Female', 'Other/Prefer Not to Say', '', null]
  - name: user_address_city
    description: str, city where user lives in, collected from the micromasters database
  - name: user_first_name
    description: str, first from the micromasters profile
  - name: user_last_name
    description: str, last name from the micromasters profile
  - name: user_full_name
    description: str, The full name of the user. Taken from either the edX database
      or the mitxonline database
  - name: user_year_of_birth
    description: str, user's birth year from the profile in the micromasters database
  - name: user_country
    description: str, Country provided by the user either on the edX platform or the
      mitxonline platform
  - name: user_address_postal_code
    description: str, postal code where user lives in from the profile in micromasters
  - name: user_street_address
    description: str, street address where user lives in from the profile in the micromasters
      database
  - name: user_address_state_or_territory
    description: str,  state or territory where user lives in from the profile in
      the micromasters database

- name: int__micromasters__course_certificates
  description: course certificates earned for MicroMasters programs. This include
    certificates are downloadable and not revoked from MITx Online, MicroMaster and
    edX.org
  columns:
  - name: program_title
    description: str, title of program the course is part of
    tests:
    - not_null
  - name: courserun_title
    description: str, title of the course run
    tests:
    - not_null
  - name: courserun_readable_id
    description: str, course run ID on edX.org or MITxOnline
    tests:
    - not_null
  - name: course_number
    description: str, unique string for the course e.g. 14.009x
    tests:
    - not_null
  - name: user_edxorg_username
    description: str, username on edX.org
  - name: user_mitxonline_username
    description: str, username on MITxOnline
  - name: user_email
    description: str, user email on edX.org or MITxOnline
    tests:
    - not_null
  - name: user_full_name
    description: str, user full name on edX.org or MITxOnline
  - name: user_country
    description: str, user country on edX.org or MITxOnline
  tests:
  - dbt_expectations.expect_compound_columns_to_be_unique:
      column_list: ["user_email", "courserun_readable_id"]

- name: int__micromasters__course_grades
  description: course grades for MicroMasters programs
  columns:
  - name: program_title
    description: str, title of program the course is part of
    tests:
    - not_null
  - name: courserun_title
    description: str, title of the course run
    tests:
    - not_null
  - name: courserun_readable_id
    description: str, course run ID on edX.org or MITxOnline
    tests:
    - not_null
  - name: course_number
    description: str, unique string for the course e.g. 14.009x
    tests:
    - not_null
  - name: user_edxorg_username
    description: str, username on edX.org
  - name: user_mitxonline_username
    description: str, username on MITxOnline
  - name: user_email
    description: str, user email on edX.org or MITxOnline
    tests:
    - not_null
  - name: user_full_name
    description: str, user full name on edX.org or MITxOnline
  - name: user_country
    description: str, user country on edX.org or MITxOnline
  - name: grade
    description: float, course grade on edX.org or MITxOnline range from 0 to 1, maybe
      blank on edX.org
  - name: is_passing
    description: boolean, indicating whether the user has passed the passing score
      set for this course on edX.org or MITxOnline
    tests:
    - not_null
  tests:
  - dbt_expectations.expect_compound_columns_to_be_unique:
      column_list: ["user_email", "courserun_readable_id"]
