---
version: 2

models:
- name: int__micromasters__program_certificates
  columns:
  - name: programcertificate_id
    description: int, sequential ID representing a program certificate. Only has records
      for DEDP
    tests:
    - unique
    - not_null
  - name: programcertificate_created_on
    description: timestamp, specifying when a program certificate was initially created
    tests:
    - not_null
  - name: programcertificate_updated_on
    description: timestamp, specifying when a program certificate was most recently
      updated
    tests:
    - not_null
  - name: programcertificate_hash
    description: str, unique hash used to identify the program certificate
    tests:
    - not_null
  - name: program_id
    description: id, int foreign key referece to courses_program
    tests:
    - not_null
  - name: user_id
    description: int, foreign key referece to auth_user
    tests:
    - not_null
  tests:
  - dbt_expectations.expect_table_row_count_to_equal_other_table:
      compare_model: ref('stg__micromasters__app__postgres__grades_programcertificate')

- name: int__micromasters__users
  description: Intermediate model of Users in MicroMasters
  columns:
  - name: user_id
    description: int, sequential ID representing a user in MicroMasters
    tests:
    - unique
    - not_null
  - name: user_username
    description: str, unique string to identify user
    tests:
    - unique
    - not_null
  - name: user_full_name
    description: str, user's full name
  - name: user_email
    description: str, user email associated with user account (not unique)
    tests:
    - not_null
  - name: user_joined_on
    description: timestamp, specifying when a user account was initially created
  - name: user_last_login
    description: timestamp, specifying when a user last logged in
  - name: user_address_country
    description: str, country code for the user's address
  - name: user_is_active
    description: boolean, indicating if user is active or not
  - name: user_mitxonline_username
    description: str, username in mitxonline
  - name: user_edxorg_username
    description: str, username in edx.org. For the very small number of users with
      multiple edx usernames, this is the username with the latest logins
  tests:
  - dbt_expectations.expect_table_row_count_to_equal_other_table:
      compare_model: ref('stg__micromasters__app__postgres__auth_user')

- name: int__micromasters__programs
  description: Intermediate model for programs in MicroMasters
  columns:
  - name: program_id
    description: int, sequential ID representing a program in MicroMasters
    tests:
    - not_null
    - unique
  - name: program_title
    description: str, title of the program
    tests:
    - not_null
  - name: program_description
    description: str, description of the program
  - name: program_num_required_courses
    description: int, indicating the number of required courses to earn certificate
    tests:
    - not_null
  - name: program_is_live
    description: boolean, indicating whether program is available to users on MicroMasters
      website
    tests:
    - not_null
  tests:
  - dbt_expectations.expect_table_row_count_to_equal_other_table:
      compare_model: ref('stg__micromasters__app__postgres__courses_program')

- name: int__micromasters__program_requirements
  description: Intermediate model for program requirements in MicroMasters
  columns:
  - name: program_id
    description: int, foreign key to courses_program
    tests:
    - relationships:
        to: ref('stg__micromasters__app__postgres__courses_program')
        field: program_id
  - name: course_id
    description: int, foreign key to courses_course
    tests:
    - relationships:
        to: ref('stg__micromasters__app__postgres__courses_course')
        field: course_id
  - name: electiveset_id
    description: int, sequential ID representing a elective requirement set for a
      program in MicroMasters
  - name: electiveset_required_number
    description: int, indicating the number of required from elective courses
  - name: programrequirement_type
    description: str, indicating the courses is either core or elective
    tests:
    - not_null
    - accepted_values:
        values: ["Core", "Elective"]
  - name: program_num_required_courses
    description: int, indicating the number of required courses to earn certificate
    tests:
    - not_null
