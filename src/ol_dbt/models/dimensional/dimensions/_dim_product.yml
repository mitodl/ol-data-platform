---
version: 2

models:
- name: dim_product
  description: >
    Product catalog dimension (SCD Type 2) representing purchasable offerings.
    Products can be for course runs or programs. Tracks price changes over time.
  columns:
  - name: product_pk
    description: Surrogate key primary key
    tests:
    - unique
    - not_null
  - name: source_product_id
    description: Product ID from source system
    tests:
    - not_null
  - name: product_type
    description: Type of product (course, program, etc.)
    tests:
    - not_null
  - name: courserun_fk
    description: Foreign key to dim_course_run (if product is for a course)
    tests:
    - relationships:
        to: ref('dim_course_run')
        field: courserun_pk
  - name: program_fk
    description: Foreign key to dim_program (if product is for a program)
    tests:
    - relationships:
        to: ref('dim_program')
        field: program_pk
  - name: platform_fk
    description: Foreign key to dim_platform
    tests:
    - not_null
    - relationships:
        to: ref('dim_platform')
        field: platform_pk
  - name: product_price
    description: Product price in product_currency
  - name: product_currency
    description: Currency code (standardized to USD)
    tests:
    - not_null
    - accepted_values:
        values: ['USD']
  - name: product_is_active
    description: Boolean indicating if product is currently active/purchasable
  - name: created_date_key
    description: Foreign key to dim_date for product creation date
    tests:
    - relationships:
        to: ref('dim_date')
        field: date_key
  - name: effective_date
    description: SCD Type 2 effective timestamp
    tests:
    - not_null
  - name: end_date
    description: SCD Type 2 end timestamp (null if current)
  - name: is_current
    description: Boolean indicating current version
    tests:
    - not_null
