---
version: 2

models:
- name: stg__bootcamps__app__postgres__courserunenrollment
  columns:
  - name: courserunenrollment_id
    description: int, sequential ID tracking a single user enrollment
    tests:
    - dbt_expectations.expect_column_to_exist
    - unique
    - not_null
  - name: courserunenrollment_created_on
    description: timestamp, specifying when an enrollment was initially created
    tests:
    - dbt_expectations.expect_column_to_exist
    - not_null
  - name: courserunenrollment_updated_on
    description: timestamp, specifying when an enrollment was most recently updated
    tests:
    - dbt_expectations.expect_column_to_exist
    - not_null
  - name: courserunenrollment_enrollment_status
    description: str, enrollment status for users whose enrollment changed. Options
      are 'deferred', 'refunded'
    tests:
    - dbt_expectations.expect_column_to_exist
    - accepted_values:
        values: ['deferred', 'refunded', null]
  - name: courserunenrollment_is_active
    description: boolean, indicating whether the user is still enrolled in the run
    tests:
    - dbt_expectations.expect_column_to_exist
    - not_null
  - name: courserun_id
    description: int, unique ID specifying a "run" of a bootcamp
    tests:
    - dbt_expectations.expect_column_to_exist
    - not_null
  - name: user_id
    description: int, unique ID for each user on the bootcamp platform
    tests:
    - dbt_expectations.expect_column_to_exist
    - not_null
  - name: courserunenrollment_novoed_sync_on
    description: timestamp, last time the enrollment was synced with novoed
    tests:
    - dbt_expectations.expect_column_to_exist
  - name: courserunenrollment_is_certificate_blocked
    description: boolean, indicates that new cretificates shouldn't be created for
      the enrollment
    tests:
    - dbt_expectations.expect_column_to_exist - not_null
  tests:
  - dbt_expectations.expect_table_column_count_to_equal:
      value: 9
  - dbt_expectations.expect_compound_columns_to_be_unique:
      column_list: ["user_id", "courserun_id"]
- name: stg__bootcamps__app__postgres__auth_user
  columns:
  - name: user_id
    description: int, sequential ID representing one user in bootcamps
    tests:
    - unique
    - not_null
    - dbt_expectations.expect_column_to_exist
  - name: user_username
    description: str, name chosen by user
    tests:
    - unique
    - not_null
    - dbt_expectations.expect_column_to_exist
  - name: user_email
    description: str, user email associated with user account. Not unique
    tests:
    - not_null
    - dbt_expectations.expect_column_to_exist
  - name: user_is_active
    description: boolean, used to soft delete user accounts
    tests:
    - dbt_expectations.expect_column_to_exist
  - name: user_joined_on
    description: timestamp, specifying when a user account was initially created
    tests:
    - dbt_expectations.expect_column_to_exist
  - name: user_last_login
    description: timestamp, specifying when a user last logged in
    tests:
    - dbt_expectations.expect_column_to_exist
  tests:
  - dbt_expectations.expect_table_column_count_to_equal:
      value: 6
- name: stg__bootcamps__app__postgres__profiles_legaladdress
  columns:
  - name: user_address_id
    description: int, sequential ID
    tests:
    - unique
    - not_null
    - dbt_expectations.expect_column_to_exist
  - name: user_address_country
    description: string, user country code
    tests:
    - not_null
    - dbt_expectations.expect_column_to_exist
  - name: user_id
    description: int, foreign key to users_user
    tests:
    - unique
    - not_null
    - dbt_expectations.expect_column_to_exist
  - name: user_last_name
    description: string, user last name
    tests:
    - not_null
    - dbt_expectations.expect_column_to_exist
  - name: user_first_name
    description: string, user first name
    tests:
    - not_null
    - dbt_expectations.expect_column_to_exist
  - name: user_street_address
    description: string, user street address
    tests:
    - not_null
    - dbt_expectations.expect_column_to_exist
  - name: user_address_city
    description: string, user city
    tests:
    - not_null
    - dbt_expectations.expect_column_to_exist
  - name: user_address_state_or_territory
    description: string, user state or territory
    tests:
    - not_null
    - dbt_expectations.expect_column_to_exist
  - name: user_address_postal_code
    description: string, user postal code
    tests:
    - not_null
    - dbt_expectations.expect_column_to_exist
  tests:
  - dbt_expectations.expect_table_column_count_to_equal:
      value: 9
- name: stg__bootcamps__app__postgres__profiles_profile
  columns:
  - name: user_profile_id
    description: int, sequential ID
    tests:
    - unique
    - not_null
    - dbt_expectations.expect_column_to_exist
  - name: user_full_name
    description: str, the user's full name
    tests:
    - not_null
    - dbt_expectations.expect_column_to_exist
  - name: user_gender
    description: str, user gender
    tests:
    - accepted_values:
        values: ['Male', 'Female', 'Other/Prefer not to say', '']
    - not_null
    - dbt_expectations.expect_column_to_exist
  - name: user_birth_year
    description: int, user birth year
    tests:
    - dbt_expectations.expect_column_to_exist
  - name: user_company
    description: str, user company
    tests:
    - not_null
    - dbt_expectations.expect_column_to_exist
  - name: user_job_title
    description: str, user job title
    tests:
    - not_null
    - dbt_expectations.expect_column_to_exist
  - name: user_industry
    description: str, user job industry
    tests:
    - not_null
    - dbt_expectations.expect_column_to_exist
  - name: user_job_function
    description: str, user job function
    tests:
    - not_null
    - dbt_expectations.expect_column_to_exist
  - name: user_company_size
    description: str, company size
    tests:
    - accepted_values:
        values: ['Small/Start-up (1+ employees)', 'Small/Home office (1-9 employees)',
          'Small (10-99 employees)', 'Small to medium-sized (100-999 employees)',
          'Medium-sized (1000-9999 employees)', 'Large Enterprise (10,000+ employees)',
          "Other (N/A or Don''t know)"]
    - dbt_expectations.expect_column_to_exist
  - name: user_years_experience
    description: str, years experience
    tests:
    - accepted_values:
        values: ['Less than 2 years', '2-5 years', '6 - 10 years', '11 - 15 years',
          '16 - 20 years', 'More than 20 years', 'Prefer not to say']
    - dbt_expectations.expect_column_to_exist
  - name: user_id
    description: int, unique ID for each user on the bootcamp platform
    tests:
    - unique
    - not_null
    - dbt_expectations.expect_column_to_exist
  - name: user_highest_education
    description: str, user highest education
    tests:
    - accepted_values:
        values: ['Doctorate', "Master''s or professional degree", "Bachelor''s degree",
          'Associate degree', 'Secondary/high school', 'Junior secondary/junior high/middle
            school', 'Elementary/primary school', 'No formal education', 'Other education',
          '']
    - not_null
    - dbt_expectations.expect_column_to_exist
  tests:
  - dbt_expectations.expect_table_column_count_to_equal:
      value: 12

- name: stg__bootcamps__app__postgres__courses_course
  description: staging model for Bootcamps courses
  columns:
  - name: course_id
    description: int, primary key representing a single bootcamp course
    tests:
    - unique
    - not_null
    - dbt_expectations.expect_column_to_exist
  - name: course_title
    description: str, title of the bootcamp course
    tests:
    - dbt_expectations.expect_column_to_exist
  tests:
  - dbt_expectations.expect_table_column_count_to_equal:
      value: 2

- name: stg__bootcamps__app__postgres__courses_courserun
  description: staging model for Bootcamps course runs
  columns:
  - name: courserun_id
    description: int, primary key representing a single bootcamp course run
    tests:
    - unique
    - not_null
    - dbt_expectations.expect_column_to_exist
  - name: course_id
    description: int, foreign key to courses_course representing a single bootcamp
      course
    tests:
    - not_null
    - dbt_expectations.expect_column_to_exist
  - name: courserun_title
    description: str, title of the bootcamp course run
    tests:
    - dbt_expectations.expect_column_to_exist
  - name: courserun_readable_id
    description: str, unique string to identify a bootcamp course run (could be blank
      for older runs)
    tests:
    - unique
    - dbt_expectations.expect_column_to_exist
  - name: courserun_start_on
    description: timestamp, specifying when the course run begins
    tests:
    - dbt_expectations.expect_column_to_exist
  - name: courserun_end_on
    description: timestamp, specifying when the course run ends
    tests:
    - dbt_expectations.expect_column_to_exist
  tests:
  - dbt_expectations.expect_table_column_count_to_equal:
      value: 6

- name: stg__bootcamps__app__postgres__courses_courseruncertificate
  columns:
  - name: courseruncertificate_id
    description: int, primary key representing a single Bootcamps course certificate
      record
    tests:
    - unique
    - not_null
    - dbt_expectations.expect_column_to_exist
  - name: courseruncertificate_uuid
    description: str, unique identifier for the certificate
    tests:
    - unique
    - not_null
    - dbt_expectations.expect_column_to_exist
  - name: courserun_id
    description: int, foreign key to courses_courserun representing a single course
      run
    tests:
    - not_null
    - dbt_expectations.expect_column_to_exist
    - relationships:
        to: ref('stg__bootcamps__app__postgres__courses_courserun')
        field: courserun_id
  - name: user_id
    description: str, foreign key to auth_user representing a single user
    tests:
    - not_null
    - dbt_expectations.expect_column_to_exist
    - relationships:
        to: ref('stg__bootcamps__app__postgres__auth_user')
        field: user_id
  - name: courseruncertificate_created_on
    description: timestamp, specifying when a certificate was initially created
    tests:
    - dbt_expectations.expect_column_to_exist
  - name: courseruncertificate_updated_on
    description: timestamp, specifying when a certificate was most recently updated
    tests:
    - dbt_expectations.expect_column_to_exist
  - name: courseruncertificate_is_revoked
    description: boolean, indicating whether the certificate is revoked and invalid
    tests:
    - dbt_expectations.expect_column_to_exist
  tests:
  - dbt_expectations.expect_table_column_count_to_equal:
      value: 7
  - dbt_expectations.expect_compound_columns_to_be_unique:
      column_list: ["user_id", "courserun_id"]
