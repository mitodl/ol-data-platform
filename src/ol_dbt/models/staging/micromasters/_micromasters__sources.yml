---
version: 2

sources:
- name: ol_warehouse_raw_data
  loader: airbyte
  database: 'ol_data_lake_{{ target.name }}'
  schema: 'ol_warehouse_{{ target.name }}_raw'
  tables:
  - name: raw__micromasters__app__postgres__auth_user
    columns:
    - name: id
      description: int, sequential ID representing a user in MicroMasters
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: password
      description: str, hashed password
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: username
      description: str, unique string to identify user
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: email
      description: str, user email associated with their account
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: first_name
      description: str, user's first name (blank for the majority of users on production)
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: last_name
      description: str, user's last name (blank for the majority of users on production)
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: is_active
      description: boolean, indicate whether this user is active (use it to soft delete
        account)
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: last_login
      description: timestamp, user's last login
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: date_joined
      description: timestamp, specifying when a user account was initially created
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: is_staff
      description: boolean, indicate whether the user can log into admin site (internally
        used)
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: is_superuser
      description: boolean, indicate whether this user has all permissions (internally
        used)
      tests:
      - dbt_expectations.expect_column_to_exist
    tests:
    - dbt_expectations.expect_table_column_count_to_equal:
        value: 11

  - name: raw__micromasters__app__postgres__profiles_profile
    columns:
    - name: id
      description: int, sequential ID representing a user profile in MicroMasters
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: user_id
      description: str, foreign key to auth_user representing a single user
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: gender
      description: str, "m", "f" or "o" to represent "Male" , "Female", "Other/Prefer
        Not to Say" (Could be blank)
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: address
      description: str, street address where user lives in
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: postal_code
      description: str, postal code where user lives in
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: city
      description: str, city where user lives in
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: state_or_territory
      description: str, state or territory where user lives in
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: country
      description: str, country where user lives in
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: birth_country
      description: str, user's country of birth
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: date_of_birth
      description: str, user's date of birth
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: edx_bio
      description: str, user's biography on edx.org
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: about_me
      description: str, about me in user profile
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: edx_name
      description: str, user's full name on edx.org
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: edx_goals
      description: str, user's personal goal on edx.org
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: fake_user
      description: boolean, used for testing profiles
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: mail_id
      description: str, UUID generated for user profile (used in automatic/bulk emails)
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: filled_out
      description: boolean, whether user filled out the profile
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: first_name
      description: str, first name on user profile
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: last_name
      description: str, last name on user profile
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: preferred_name
      description: str, user's Nickname / Preferred name
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: romanized_last_name
      description: str, user's last name in roman (populated when first_name is non-romanized)
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: romanized_first_name
      description: str, user's first name in roman (populated when last_name is non-romanized)
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: student_id
      description: int, incremental ID for profile, it's default to primary key
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: updated_on
      description: timestamp, specifying when a profile was most recently updated
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: email_optin
      description: boolean, whether user has opted to receive email
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: image
      description: str, relative url of the profile image. e.g.profile/xxxxx.jpg
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: image_small
      description: str, relative url of the profile image in 64x64 pixel e.g.profile/xxxxx.jpg
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: image_medium
      description: str, relative url of the profile image in 128x128 pixels e.g.profile/xxxxx_medium.jpg
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: nationality
      description: str, user's nationality (stored as country code)
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: edx_employer
      description: str, user's employer
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: phone_number
      description: str, user's phone number
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: edx_job_title
      description: str, user's job title on edx.org
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: account_privacy
      description: str, whether user account is "Public to everyone" (public), "Public
        to logged in users" (public_to_mm) or "Private" (private)
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: preferred_language
      description: str, user's preferred language
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: edx_mailing_address
      description: str, user's mailing address on edx.org
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: edx_level_of_education
      description: >
        str, user education level choices are:
        "p" - "Doctorate"
        "m" - "Master's or professional degree"
        "b" - "Bachelor's degree"
        "a" - "Associate degree"
        "hs" - "High school"
        "jhs" - "Junior high school"
        "el" - "Elementary school"
        "none" - "No formal education"
        "other" - "Other education"
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: date_joined_micromasters
      description: timestamp, specifying when user profile was initially created
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: verified_micromaster_user
      description: boolean, whether the user is a verified MicroMasters user (currently
        false to all users on production)
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: agreed_to_terms_of_service
      description: boolean, whether the user has agreed to term of service
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: edx_language_proficiencies
      description: str, JSON string of user's language proficiencies on edx.org
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: edx_requires_parental_consent
      description: boolean, user profile requires parental consent on edx.org
      tests:
      - dbt_expectations.expect_column_to_exist
    tests:
    - dbt_expectations.expect_table_column_count_to_equal:
        value: 41

  - name: raw__micromasters__app__postgres__social_auth_usersocialauth
    columns:
    - name: id
      description: int, sequential ID representing a user social auth record in MicroMasters
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: user_id
      description: str, foreign key to auth_user representing a single user
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: provider
      description: str, social auth provider. It's either "edxorg" or "mitxonline"
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: uid
      description: str, user name string to identify a user within a social auth provider
      tests:
      - dbt_expectations.expect_column_to_exist
    - name: extra_data
      description: str, extra data for this user social auth in JSON string
      tests:
      - dbt_expectations.expect_column_to_exist
    tests:
    - dbt_expectations.expect_table_column_count_to_equal:
        value: 5
