---
version: 2

models:
- name: stg__edxorg__bigquery__mitx_courserun
  description: MITx courses metadata from edX.org and MITxOnline courses
  columns:
  - name: courserun_readable_id
    description: str, The canonical ID of the course run in the format as {org}/{course}/{run}.
    tests:
    - unique
    - not_null
  - name: courserun_platform
    description: str, indicating what platform the course is from, MITx Online/xPro
      open edx or edx.org
    tests:
    - accepted_values:
        values: '{{ var("platforms") }}'
  - name: courserun_title
    description: str, The title of the course run, maybe blank
  - name: courserun_url
    description: str, The url path of the course run
  - name: course_number
    description: str, unique string for the course. It can contain letters, numbers,
      or periods. e.g. 6.002.1x (extra space are cleaned up for this data set)
  - name: courserun_semester
    description: str, The semester during which the course was launched e.g Fall 2020
  - name: courserun_enrollment_start_date
    description: date, registration open date for the course
  - name: courserun_start_date
    description: date, The date on which the course starts
  - name: courserun_end_date
    description: date, The date on which the course ends
  - name: courserun_is_self_paced
    description: boolean, Indicate whether or not the course is self paced
  - name: courserun_institution
    description: str, The institution that is linked to the course. Values are currently
      MITProfessionalX, MITx, MITxPRO
  - name: courserun_instructors
    description: str, List of instructors associated with the course
  - name: course_readable_id
    description: str, Open edX ID for the course formatted as {org}/{course}
    tests:
    - not_null
  - name: coursedepartment_name
    description: str, course department name
  - name: coursedepartment_number
    description: int, course department number

- name: stg__edxorg__bigquery__mitx_person_course
  description: It contains user activities from edX.org, MITxOnline/xPro open edx
    and certain enrollment/certificate fields from edx.org
  columns:
  - name: user_id
    description: int, Numerical user ID of a learner on a specific edX platform -
      MITx Online/xPro open edx or edx.org
    tests:
    - not_null
  - name: courserun_readable_id
    description: str, The canonical ID of the course run in the format as {org}/{course}/{run}.
      This is old format and could be different from courses in MITxOnline or MicroMasters
      that use new format
    tests:
    - not_null
  - name: courserun_platform
    description: str, indicating what platform the data is from, MITx Online/xPro
      open edx or edx.org
    tests:
    - accepted_values:
        values: '{{ var("platforms") }}'
  - name: user_username
    description: str, username of a learner on the edX platform (some blank from source)
  - name: user_gender
    description: str, user's gender - blank means user did not specify a gender. Null
      means this student signed up before this information was collected
    tests:
    - accepted_values:
        values: '{{ var("gender_values") }}'
  - name: user_highest_education
    description: str, user's Level of education- blank means User did not specify
      level of education. Null means this student signed up before this information
      was collected
    tests:
    - accepted_values:
        values: ["Doctorate", "Master''s or professional degree", "Bachelor''s degree",
          "Associate degree", "Secondary/high school", "Junior secondary/junior high/middle\
            \ school", "Elementary/primary school", "No formal education", "Other\
            \ education", "Doctorate in science or engineering", "Doctorate in another\
            \ field", "", null]
  - name: user_birth_year
    description: int, A year of birth provided by the learner on their profile
  - name: user_profile_country
    description: str, two-letter country code as specified by user in their profile
      (only available after ~mid-2014)
  - name: courserunenrollment_enrollment_mode
    description: str, enrollment mode, e.g. honor, audit, verified
  - name: courserunenrollment_created_on
    description: timestamp, timestamp of user's enrollment in the course
  - name: courserunenrollment_enrolled_on
    description: timestamp, timestamp on when user initially had their first id-verified
      enrollment event
  - name: courserunenrollment_unenrolled_on
    description: timestamp, timestamp on when user had their last id-verified unenrollment
      event, if any. Null if there were no unenrollment events
  - name: courserunenrollment_is_active
    description: boolean, indicating if enrollment is active or not
  - name: courseruncertificate_is_earned
    description: boolean, indicating that the user earned a certificate in the course
  - name: courseruncertificate_status
    description: str, one of downloadable, notpassing, audit_passing, unavailable,
      audit_notpassing where downloadable should = earned
  - name: courseruncertificate_created_on
    description: timestamp, timestamp when certificate was generated (if applicable)
  - name: courseruncertificate_updated_on
    description: timestamp, timestamp when certificate was modified (if applicable)
  - name: courserungrade_passing_grade
    description: float, Passing grade for the course, (range between 0.0 to 1.0)
  - name: courserungrade_user_grade
    description: float, Final grade user earned in the course, (range between 0.0
      to 1.0)
  - name: courserungrade_is_passing
    description: boolean, indicating that the user completed the course with a passing
      grade
  - name: courseactivitiy_visited_once
    description: boolean, indicating that the user visited the course at least once
  - name: courseactivitiy_viewed_half
    description: boolean, indicating that the user viewed at least half of the chapters
      of the course
  - name: courseactivitiy_num_events
    description: int, Number of tracking log events
  - name: courseactivitiy_num_activity_days
    description: int, Number of days with activity from tracking logs
  - name: courseactivitiy_num_progress_check
    description: int, Number of progress check events from tracking logs
  - name: courseactivitiy_num_problem_check
    description: int, Number of problem_check interaction events from tracking logs
  - name: courseactivitiy_num_show_answer
    description: int, Number of show_answer events from tracking logs
  - name: courseactivitiy_num_show_transcript
    description: int, Number of show_transcript video interaction events from tracking
      logs
  - name: courseactivitiy_num_seq_goto
    description: int, Number of sequence_goto navigational events from tracking logs
  - name: courseactivitiy_num_play_video
    description: int, Number of play_video video interaction events from tracking
      logs
  - name: courseactivitiy_num_seek_video
    description: int, Number of seek_video video interaction events from tracking
      logs
  - name: courseactivitiy_num_pause_video
    description: int, Number of pause_video video interaction events from tracking
      logs
  - name: courseactivitiy_num_video_interactions
    description: int, Number of all the video interaction events from tracking log
  - name: courseactivitiy_num_unique_videos_viewed
    description: int, Number of Unique Videos viewed per user within a course
  - name: courseactivitiy_percentage_total_videos_watched
    description: int, Percentage of all videos watched per user within a course
  - name: courseactivitiy_average_time_diff_in_sec
    description: float, Average time difference in seconds between consecutive events
      from tracking logs
  - name: courseactivitiy_standard_deviation_in_sec
    description: float, Standard deviation of difference in seconds between consecutive
      events from tracking logs
  - name: courseactivitiy_max_diff_in_sec
    description: float, Maximum difference in seconds between consecutive events from
      tracking logs
  - name: courseactivitiy_num_consecutive_events_used
    description: int, Number of consecutive events used in time difference computations,
      from tracking logs
  - name: courseactivitiy_total_elapsed_time_in_sec
    description: int, Total elapsed time (in seconds) spent by user on this course,
      based on time difference of consecutive events, with 5 min max cutoff, from
      tracking logs
  - name: courseactivitiy_first_event_timestamp
    description: timestamp, timestamp of first event of user from tracking logs
  - name: courseactivitiy_last_event_timestamp
    description: timestamp, timestamp of last event of user from tracking logs
  tests:
  - dbt_expectations.expect_compound_columns_to_be_unique:
      column_list: ["user_id", "courserun_readable_id"]

- name: stg__edxorg__bigquery__mitx_user_info_combo
  description: This contains users from edX.org, MITxOnline/xPro open edx sources
    and complete enrollments/certificates fields from edX.org
  columns:
  - name: user_id
    description: int, Numerical user ID of a learner on a specific edX platform -
      MITx Online/xPro open edx or edx.org
    tests:
    - not_null
  - name: courserun_platform
    description: str, indicating what platform the data is from, MITx Online/xPro
      open edx or edx.org. It could be null in this table
  - name: user_username
    description: str, The username of the learner on the edX platform
  - name: user_full_name
    description: str, The full name of the user on the edX platform
  - name: user_email
    description: str, The email address of the learner on the edX platform (could
      be blank)
  - name: user_map_hash_id
    description: str, A hashed ID mapping learner user ID's to external systems
  - name: user_mailing_address
    description: str, Mailing address provided by the learner on their profile
  - name: user_profile_goals
    description: str, The intended goals of the learner provided on their profile
  - name: user_gender
    description: str, Gender selected by the user on their profile
    tests:
    - accepted_values:
        values: '{{ var("gender_values") }}'
  - name: user_country
    description: str, Country selected by the learner on their profile
  - name: user_city
    description: str, City selected the learner on their profile (Not currently used)
      History - Added in Jan 2014, not yet implemented.
  - name: user_highest_education
    description: str, user's Level of education- blank means User did not specify
      level of education. Null means this student signed up before this information
      was collected
    tests:
    - accepted_values:
        values: ["Doctorate", "Master''s or professional degree", "Bachelor''s degree",
          "Associate degree", "Secondary/high school", "Junior secondary/junior high/middle\
            \ school", "Elementary/primary school", "No formal education", "Other\
            \ education", "Doctorate in science or engineering", "Doctorate in another\
            \ field", "", null]
  - name: user_birth_year
    description: int, A year of birth provided by the learner on their profile
  - name: user_profile_meta
    description: str, extra metadata on learner's profile. JSON data in text field
  - name: user_joined_on
    description: timestamp, timestamp that the account was created.
  - name: user_last_login
    description: timestamp, Timestamp indicating the last time the user logged into
      the edX platform
  - name: courserunenrollment_courserun_readable_id
    description: str, course ID user is enrolling in. It's in the format as org/number/semester
      this field is not always populated here, but it's always populated in person_course
  - name: courserunenrollment_mode
    description: str, indicate what kind of enrollment it is - mode, no-id-professional,
      audit, honor, verified, professional, credit
  - name: courserunenrollment_created_on
    description: timestamp, Timestamp indicating when the enrollment event was created
  - name: courserunenrollment_is_active
    description: int, Whether or not the enrollment is active. 1 means active
  - name: courseruncertificate_id
    description: int, The ID of the certificate obtained by the user. Null if the
      user obtained no certificate.
  - name: courseruncertificate_courserun_readable_id
    description: str, The course ID associated with the certificate. It's in the format
      as org/number/semester
  - name: courseruncertificate_user_id
    description: int, The user ID tied to the certificate
  - name: courseruncertificate_mode
    description: str, The enrollment mode associated with the certificate
  - name: courseruncertificate_distinction
    description: int, This was used for letters of distinction for 188.1x, but is
      not being used for any current courses
  - name: courseruncertificate_created_on
    description: timestamp, Timestamp indicating when the certificate was created
  - name: courseruncertificate_updated_on
    description: timestamp, Timestamp indicating the last time the certificate was
      modified
  - name: courseruncertificate_name
    description: str, The name of the user that is listed on the certificate
  - name: courseruncertificate_key
    description: str, A random string that is used to match server requests to responses
      sent to the LMS. Used internally only
  - name: courseruncertificate_status
    description: str, Status of the generation of the certificate
  - name: courseruncertificate_download_url
    description: str, the full URL to the certificate
  - name: courseruncertificate_download_uuid
    description: str, A hash code that identifies this student’s certificate. Included
      as part of the download_url.
  - name: courseruncertificate_verify_uuid
    description: str, A hash code that verifies the validity of a certificate. Included
      on the certificate itself as part of a URL.
  - name: courseruncertificate_grade
    description: float, The grade when the certificate was generated

- name: stg__edxorg__bigquery__mitx_user_email_opt_in
  description: It contains email opt-in preferences for edX.org courses. If users
    enroll in multiple courses, the email and username in this table are expected
    to be the most recent data.
  columns:
  - name: user_id
    description: int, Numerical user ID of a learner on a specific edX platform -
      MITx Online/xPro open edx or edx.org
    tests:
    - not_null
  - name: user_username
    description: str, The username of the user on the edX platform
    tests:
    - not_null
  - name: user_email
    description: str, The email address of the user on the edX platform
    tests:
    - not_null
  - name: user_full_name
    description: str, The full name of the user on the edX platform
  - name: courserun_readable_id
    description: str, The course ID formatted as {org}/{course}/{run}
    tests:
    - not_null
  - name: courserun_platform
    description: str, indicating what platform the data is from, MITx Online/xPro
      open edx or edx.org
    tests:
    - accepted_values:
        values: '{{ var("platforms") }}'
  - name: user_is_opted_in_for_email
    description: boolean, indicating if the learner has opted to receive marketing
      emails
  - name: user_email_opt_in_updated_on
    description: timestamp, specifying when email opt in preference was most recently
      updated
  tests:
  - dbt_expectations.expect_compound_columns_to_be_unique:
      column_list: ["user_id", "courserun_readable_id"]

- name: stg__edxorg__s3__program_learner_report
  description: learners program and course records in MicroMasters and XSeries programs
    from edX.org
  columns:
  - name: org_id
    description: str, the name of the organization that is the author for the program
      for which this report was generated. Currently, it's MITx for all records.
    tests:
    - not_null
  - name: program_type
    description: str, the type of the program. The value are 'MicroMasters' and 'XSeries'
      for MITx programs on edX.org
    tests:
    - not_null
    - accepted_values:
        values: ['MicroMasters', 'XSeries']
  - name: program_uuid
    description: str, the UUID of the program on edX.org. Each program and its separate
      track have a different UUID.
    tests:
    - not_null
  - name: program_title
    description: str, title of the program, including the specific track if applicable.
    tests:
    - not_null
  - name: program_track
    description: str, name of the specific track for MicroMasters programs. For example,
      Statistics and Data Science program has multiple tracks - General Track, Methods
      Track, Social Sciences Track, and 'Time Series and Social Sciences Track'.
  - name: user_id
    description: int, the edX learner ID in the LMS in a user's course run enrollment
      record.
    tests:
    - not_null
  - name: user_username
    description: str, username of the user on edX.org
    tests:
    - not_null
  - name: user_full_name
    description: str, the full name of an edX learner in the LMS in a user's user
      profile record. Retired users will have no full name available.
    tests:
    - not_null
  - name: user_roles
    description: str, roles assigned to the user. A user can have multiple roles.
      Values are beta_testers, data_researcher, finance_admin, sales_admin, instructor,
      staff, etc.
  - name: courserun_readable_id
    description: str, the key of the course-run the learner has enrolled in, formatted
      as course-v1:{org}+{course}+{run}
    tests:
    - not_null
  - name: course_title
    description: str, the course run title on edX.org
    tests:
    - not_null
  - name: courserunenrollment_enrollment_mode
    description: str, the course mode of the learner's enrollment in this course-run.
      Also called enrollment mode. Values are 'audit', 'verified', 'honor' and 'credit'
      in this table.
    tests:
    - not_null
  - name: courserungrade_letter_grade
    description: str, the letter grade for the user in the course run. This value
      is based on the course run's grading policy. The letter grade may be blank if
      the grading/credentials task has not yet run for this learner. Values are 'A',
      'B', 'C', 'D', 'F', 'Pass'
  - name: courserungrade_grade
    description: str, the current grade for the user in this course-run as a decimal
      (e.g. 0.84). If this value is null, the user does not yet have a course grade
      in this course-run.
  - name: courserunenrollment_is_active
    description: boolean, whether the learner is currently enrolled in the course.
    tests:
    - not_null
  - name: user_has_purchased_as_bundle
    description: boolean, whether the learner has purchased this course as bundle.
    tests:
    - not_null
  - name: user_has_completed_program
    description: boolean, whether the learner has passed each of the courses in the
      program with a grade that qualifies them for a verified certificate.
    tests:
    - not_null
  - name: user_has_completed_course
    description: boolean, whether the learner completed the course run. true if a
      verified learner has earned a certificate in a course run that counts towards
      program completion. This is based on the user's course certificate in the LMS.
      A course certificate counts towards completion if the learner has passed the
      course and the course run mode matches the mode of the course. Learner certificates
      for unverified accounts do not count towards program completion until the account
      is verified.
  - name: completed_course_on
    description: timestamp, the date in ISO-8601 format that the learner earned a
      passing certificate for this course run. If a user passes the course before
      verification, then the completed date will reflect the date the certificate
      was generated for that verified learner.
  - name: program_certificate_awarded_on
    description: timestamp, the date in ISO-8601 format that the learner has passed
      each of the courses in the program and was awarded a program certificate. This
      is the first date that the learner was awarded a program certificate.
  - name: courserun_start_on
    description: timestamp, the start date of the course run in ISO-8601 string.
    tests:
    - not_null
  - name: courserunenrollment_created_on
    description: timestamp,the date in ISO-8601 format that the learner enrolled in
      this course run for the first time. For example, if the learner enrolled in
      the course run, unenrolled, and then re-enrolled, this value would represent
      the time that they enrolled in the course run for the first time.
    tests:
    - not_null
  - name: courseactivity_last_activity_date
    description: date, the date in ISO-8601 format that the learner was last active
      in the course run.
  - name: courserunenrollment_unenrolled_on
    description: timestamp, the date in ISO-8601 format that the learner last unenrolled
      in this course run. This will be null if the learner has never unenrolled from
      this course run. For example, if the learner enrolled in the course run, unenrolled,
      reenrolled, and then unenrolled, this value would represent the most recent
      time that they unenrolled in the course run.
  - name: courserunenrollment_upgraded_on
    description: timestamp, the date in ISO-8601 format that the learner first upgraded
      to the verified track course mode.
  tests:
  - dbt_expectations.expect_compound_columns_to_be_unique:
      column_list: ["user_id", "courserun_readable_id", "program_uuid"]

- name: stg__edxorg__s3__tracking_logs__user_activity
  description: edX.org event data that are emitted by server, the browser, or the
    mobile device to capture information about user's interactions with a course.
    This table filters out events that don't supply user identifiers like username
    and user_id.
  columns:
  - name: user_username
    description: str, username of a learner on edX.org
    tests:
    - not_null
  - name: user_id
    description: int, learner's user ID on edX.org. Extracted from context field.
    tests:
    - not_null
  - name: courserun_readable_id
    description: str, open edX Course ID formatted as course-v1:{org}+{course}+{run}
      for course runs since Fall 2014, {org}/{course number}/{run} for older runs.
      Extracted from various fields - context.course_id, context.path, event_type
      and page. Note that the course ID extracted from context field may not be a
      valid. This field could be blank for any events that are not for any specific
      course .e.g. user login/out.
  - name: org_id
    description: str, reference name in organizations_organization from open edX.
      e.g. MITx . Extracted from context field.
  - name: useractivity_path
    description: str, URL that generated this event. Extracted from context field
  - name: useractivity_context_object
    description: object, it includes member fields that provide contextual information.
      Common fields apply to all events are course_id, org_id, path, user_id. Other
      member fields for applicable events are course_user_tags, module.
  - name: useractivity_event_source
    description: str, specifies the source of the interaction that triggered the event.
      The values are - browser, mobile, server, task
    tests:
    - not_null
  - name: useractivity_event_type
    description: str, type of event triggered. Values depend on event_source.
    tests:
    - not_null
  - name: useractivity_event_name
    description: str, type of event triggered. When this field is present for an event,
      it supersedes the event_type field.
  - name: useractivity_event_object
    description: object,it includes member fields that identify specifics of each
      triggered event. Different member fields are supplied for different events.
    tests:
    - not_null
  - name: useractivity_page_url
    description: str, url of the page the user was visiting when the event was emitted.
  - name: useractivity_session_id
    description: str, 32-character value to identify the user’s session. All browser
      events and the server 'enrollment' events include session value. Other server
      events and mobile events do not include a session value.
  - name: useractivity_ip
    description: str, IP address of the user who triggered the event. Empty for mobile
      events.
  - name: useractivity_http_host
    description: str, The site visited by the user. e.g. courses.edx.org
    tests:
    - not_null
  - name: useractivity_http_user_agent
    description: str, browser agent string of the user who triggered the event.
  - name: useractivity_http_accept_language
    description: str, value from the HTTP Accept-Language request-header field
  - name: useractivity_http_referer
    description: str, URI from the HTTP Referer request-header field
  - name: useractivity_timestamp
    description: timestamp, time at which the event was emitted, formatted as ISO
      8601 string
    tests:
    - not_null
  tests:
  - dbt_expectations.expect_compound_columns_to_be_unique:
      column_list: ["user_username", "useractivity_context_object", "useractivity_event_source",
        "useractivity_event_type", "useractivity_event_object", "useractivity_timestamp"]

- name: stg__edxorg__s3__courserun_enrollment
  description: edX.org course run enrollments
  columns:
  - name: courserunenrollment_id
    description: int, primary key for course enrollment
    tests:
    - unique
    - not_null
  - name: courserun_readable_id
    description: str, open edX Course Key formatted as course-v1:org+course_number+run.
    tests:
    - not_null
  - name: user_id
    description: int, user ID on edX.org
    tests:
    - not_null
  - name: courserunenrollment_mode
    description: str, indicating what kind of enrollment it is. Possible values are
      honor, audit, credit, verified, unpaid-executive-education, professional, no-id-professional.
    tests:
    - not_null
  - name: courserunenrollment_is_active
    description: boolean, indicating whether this enrollment is active
    tests:
    - not_null
  - name: courserunenrollment_created_on
    description: timestamp, date and time when this enrollment was created
    tests:
    - not_null
  tests:
  - dbt_expectations.expect_compound_columns_to_be_unique:
      column_list: ["user_id", "courserun_readable_id"]

- name: stg__edxorg__s3__courserun_grade
  description: edx.org course grades ingested from CSV files on OL S3 bucket
  columns:
  - name: courserun_readable_id
    description: str, open edX Course Key formatted as course-v1:org+course_number+run.
    tests:
    - not_null
  - name: user_id
    description: int, user ID on edX.org
    tests:
    - not_null
  - name: courserungrade_grading_policy_hash
    description: str, a SHA-1 digest of the course grading policy, used to detect
      and update grades whenever the policy changes
    tests:
    - not_null
  - name: courserungrade_grade
    description: float, calculated course grade as a decimal percentage, per grading
      policy. e.g. 0.91 means 91%
    tests:
    - not_null
  - name: courserungrade_letter_grade
    description: str, calculated course grade as a letter value (e.g., A-D, Pass),
      per grading policy If the learner's grade is Fail or F, this value is empty.
  - name: courserungrade_first_passed_on
    description: timestamp, date and time when the learner first passed the course.
      If this value is empty, the learner never passed the course. If this value is
      non-empty but the letter_grade value is empty, the learner transitioned from
      passing to not passing.
  - name: courserungrade_created_on
    description: timestamp, date and time when the course grade was first calculated
      for this user for this course run.
    tests:
    - not_null
  - name: courserungrade_updated_on
    description: timestamp, date and time when the course grade was was last updated
      for this user for this course run
    tests:
    - not_null
  tests:
  - dbt_expectations.expect_compound_columns_to_be_unique:
      column_list: ["user_id", "courserun_readable_id"]

- name: stg__edxorg__s3__course_structure
  description: This table captures the historical changes made to the edX.org course
    structure by comparing the new course block to the course block from the previous
    day. If no changes are detected, no new rows are added to the table. If there
    are any changes to the course structure, all blocks, including the updated or
    new ones, are added to the table.
  columns:
  - name: courserun_readable_id
    description: str, course ID formatted as {org}/{course code}/{run_tag}
    tests:
    - not_null
  - name: coursestructure_content_hash
    description: str, sha256 hashed string of the course content.
    tests:
    - not_null
  - name: coursestructure_block_content_hash
    description: str, sha256 hashed string of the block content in a course
    tests:
    - not_null
  - name: coursestructure_block_id
    description: str, Unique ID for a distinct piece of content in a course, formatted
      as block-v1:{org}+{course}+{run}type@{block type}+block@{hash code}
    tests:
    - not_null
  - name: coursestructure_parent_block_id
    description: str, parent block ID, same format as block_id
  - name: coursestructure_block_index
    description: int, sequence number giving order in which this block content appears
      within the course
    tests:
    - not_null
  - name: coursestructure_block_category
    description: str, category/type of the block, it identifies core structural elements
      of a course. Value includes but not limited to course, chapter, sequential,
      vertical, discussion, html, problem, video, etc.
    tests:
    - not_null
  - name: coursestructure_block_title
    description: str, title of the block extracted from the metadata of the block.
      This field comes from name field for the section, subsection, or unit on the
      Studio 'Course Outline' page.
  - name: coursestructure_block_metadata
    description: str, json string of the metadata field for the block. It provides
      additional information about this block, different block type may have different
      member fields inside metadata.
    tests:
    - not_null
  - name: courserun_title
    description: str, title of the course extracted from the metadata of 'course'
      block
  - name: coursestructure_retrieved_at
    description: timestamp, indicating when this course structure was initially retrieved
      from S3
    tests:
    - not_null
  tests:
  - dbt_expectations.expect_compound_columns_to_be_unique:
      column_list: ["courserun_readable_id", "coursestructure_block_id", "coursestructure_content_hash",
        "coursestructure_retrieved_at"]

- name: stg__edxorg__s3__course_xml_blocks
  description: Comprehensive block-level data extracted from edX.org course XML archives.
    This table contains all course components parsed directly from the XML structure,
    including chapters, sequentials, verticals, and content blocks like videos, problems,
    and HTML components.
  columns:
  - name: courserun_readable_id
    description: str, course ID formatted as course-v1:{org}+{course}+{run}
    tests:
    - not_null
  - name: coursestructure_xml_block_id
    description: str, unique identifier for the block from XML url_name attribute or filename
    tests:
    - not_null
  - name: coursestructure_xml_block_type
    description: str, category/type of the XML block such as chapter, sequential, vertical,
      video, problem, html, discussion, lti, etc.
    tests:
    - not_null
  - name: coursestructure_xml_block_display_name
    description: str, display name of the block from the XML display_name attribute
  - name: coursestructure_xml_block_attributes
    description: json, complete set of XML attributes for the block as a JSON object
  - name: coursestructure_xml_block_path
    description: str, path to the XML file within the course archive
    tests:
    - not_null
  - name: video_edx_id
    description: str, for video blocks, the edX video ID used to reference the video
  - name: video_duration
    description: decimal, for video blocks, the duration in seconds
  - name: problem_max_attempts
    description: str, for problem blocks, maximum number of attempts allowed
  - name: problem_weight
    description: str, for problem blocks, the weight/points value for grading
  - name: problem_markdown
    description: str, for problem blocks, markdown content if present
  - name: coursestructure_xml_retrieved_at
    description: timestamp, ISO8601 timestamp when the block data was extracted from the archive
    tests:
    - not_null
  tests:
  - dbt_expectations.expect_compound_columns_to_be_unique:
      column_list: ["courserun_readable_id", "coursestructure_xml_block_id", 
        "coursestructure_xml_block_type", "coursestructure_xml_retrieved_at"]

- name: stg__edxorg__s3__user
  description: edx.org user data
  columns:
  - name: user_id
    description: int, primary key for this user table
    tests:
    - unique
    - not_null
  - name: user_username
    description: str, the unique username for a user on edX.org.
    tests:
    - unique
    - not_null
  - name: user_email
    description: str, the user’s email address, which is the primary mechanism users
      use to log in.
    tests:
    - not_null
  - name: user_is_staff
    description: boolean, set to true if the user is a staff member of edx, who have
      Admin privileges in the LMS
    tests:
    - not_null
  - name: user_is_active
    description: boolean, set to true if the user has clicked on the activation link
      that was sent to them when they created their account, and false if user hasn't
      activated the account or the account is soft deleted
    tests:
    - not_null
  - name: user_is_superuser
    description: boolean, controls access to django_admin views. Set to true only
      for site admins. false for almost everybody.
    tests:
    - not_null
  - name: user_last_login
    description: timestamp, date and time of the user’s last login. Should not be
      used as a proxy for activity, since people can use the site all the time and
      go days between logging in and out.
  - name: user_joined_on
    description: timestamp, date and time indicating when the account was created.
      This is not the date that the user activated the account.
    tests:
    - not_null

- name: stg__edxorg__s3__user_profile
  description: edx.org user profile data
  columns:
  - name: user_profile_id
    description: int, primary key for user profile table
    tests:
    - unique
    - not_null
  - name: user_id
    description: int, foreign key to auth_user.id
    tests:
    - unique
    - not_null
  - name: user_full_name
    description: str, a user’s full name. Name changes are logged in the meta field.
  - name: user_gender
    description: str, learner's gender in readable text
    tests:
    - accepted_values:
        values: '{{ var("gender_values") }}'
  - name: user_highest_education
    description: str, learner's Level of education in readable text.
    tests:
    - accepted_values:
        values: '{{ var("highest_education_values") }}'
  - name: user_year_of_birth
    description: int, learner's birth year.
  - name: user_address_country
    description: str, two digit country code. Null for user profiles created before
      18 Sep 2014.
  - name: user_profile_metadata
    description: text, freeform text field that stores arbitrary JSON metadata e.g.
      old_names, old_emails for the user
  - name: user_goals
    description: text, collected during registration to answer question "Tell us why
      you’re interested in edX"
  - name: user_bio
    description: text, one or more paragraphs of biographical information that the
      learner enters as profile information. Added 22 Apr 2015.

- name: stg__edxorg__s3__courserun_certificate
  description: edx.org course runs certificate data
  columns:
  - name: courseruncertificate_id
    description: int, primary key for certificates_generatedcertificate table
    tests:
    - unique
    - not_null
  - name: user_id
    description: int, foreign key to auth_user.id
    tests:
    - not_null
  - name: courserun_readable_id
    description: str, open edX Course ID formatted as {org}/{course number}/{run}
      for older runs prior to 3T2015, and course-v1:{org}+{course}+{run} for newer
      runs.
    tests:
    - not_null
  - name: courseruncertificate_status
    description: str, after certificates have been issued, the status will be one
      of the possible values- audit_notpassing, audit_passing, deleted, deleting,
      downloadable, error, generating, notpassing, restricted , unavailable, unverified
    tests:
    - accepted_values:
        values: ["audit_notpassing", "audit_passing", "deleted", "deleting", "downloadable",
          "error", "generating", "notpassing", "restricted", "unavailable", "unverified"]
  - name: courseruncertificate_download_url
    description: str, url location for the generated certificate. Used internally
      only.
  - name: courseruncertificate_download_uuid
    description: str, the unique identifier for the generated certificate. Used internally
      only.
  - name: courseruncertificate_verify_uuid
    description: str, a hash code that verifies the validity of a certificate. Included
      on the certificate itself as part of a URL.
  - name: courseruncertificate_grade
    description: float, the grade ranged from '0' to '1' computed the at the time
      of certificate generation. It is suggested that the grades_persistentcoursegrade
      table be used instead of this grade.
  - name: courseruncertificate_mode
    description: str, contains the value in student_courseenrollment.mode field at
      the time the certificate was generated
  - name: courseruncertificate_user_full_name
    description: str, the name of the learner that was set at the time the certificate
      was generated.
  - name: courseruncertificate_key
    description: str, used internally only.
  - name: courseruncertificate_created_on
    description: timestamp, date and time string indicating when the certificate was
      created
  - name: courseruncertificate_updated_on
    description: timestamp, date and time string indicating when the certificate was
      last modified
  tests:
  - dbt_expectations.expect_compound_columns_to_be_unique:
      column_list: ["courserun_readable_id", "user_id"]

- name: stg__edxorg__s3__user_courseaccessrole
  description: edX.org student course access roles that lists the users who have a
    privileged role or roles for working in a course
  columns:
  - name: user_id
    description: int, foreign key to auth_user.id
    tests:
    - not_null
  - name: courserun_readable_id
    description: str, open edX Course ID formatted as {org}/{course number}/{run}
      for older runs prior to 3T2015, and course-v1:{org}+{course}+{run} for newer
      runs.
    tests:
    - not_null
  - name: courserun_edx_readable_id
    description: str, open edX Course ID formatted as {org}/{course number}/{run}
      for all runs.
    tests:
    - not_null
  - name: organization
    description: str, the organization the course belongs to. e.g. MITx
  - name: courseaccess_role
    description: str, the privilege level assigned to the user for working in this
      course. Possible values are instructor, staff, beta_testers, data_researcher,
      ccx_coach, limited_staff, sales_admin, beta_testers, finance_admin
    tests:
    - not_null
    - accepted_values:
        values: ['staff', 'limited_staff', 'data_researcher', 'instructor', 'finance_admin',
          'sales_admin', 'beta_testers', 'ccx_coach']
  tests:
  - dbt_expectations.expect_compound_columns_to_be_unique:
      column_list: ["courserun_readable_id", "user_id", "courseaccess_role"]

- name: stg__edxorg__s3__courserun
  description: edX.org course metadata extracted from course archive
  columns:
  - name: courserun_readable_id
    description: str, open edX Course ID formatted as course-v1:{org}+{course}+{run}
    tests:
    - unique
    - not_null
  - name: courserun_edx_readable_id
    description: str, open edX Course ID format as {org}/{course}/{run}. This may
      be used for joins with other tables
    tests:
    - unique
    - not_null
  - name: course_number
    description: str, unique string for the course. It can contain letters, numbers,
      or periods. e.g. CTL.SC2x
    tests:
    - not_null
  - name: courserun_tag
    description: str, the run tag from the course ID, e.g., 2T2023
    tests:
    - not_null
  - name: courserun_institution
    description: str, institution for the course, e.g., MITx
    tests:
    - not_null
  - name: courserun_title
    description: str, title of the course run
    tests:
    - not_null
  - name: courserun_start_on
    description: timestamp, specifying when the course begins
  - name: courserun_end_on
    description: timestamp, specifying when the course ends
  - name: courserun_enrollment_start_on
    description: timestamp, specifying when enrollment starts
  - name: courserun_enrollment_end_on
    description: timestamp, specifying when enrollment ends
  - name: courserun_instructors
    description: array, array of instructors' name
  - name: self_paced
    description: boolean, indicating whether the course is self_paced or instructor-paced

- name: stg__edxorg__s3__courseware_studentmodule
  description: It holds the most current course state and score per course section
    for learners on edX.org. There is a separate row for every piece of content that
    a learner accesses.
  columns:
  - name: studentmodule_id
    description: int, primary key in courseware_studentmodule
    tests:
    - not_null
    - unique
  - name: user_id
    description: int, reference user id in auth_user
    tests:
    - not_null
  - name: courserun_readable_id
    description: str, open edX Course ID formatted as course-v1:{org}+{course}+{run}
      for course runs since Fall 2014, {org}/{course number}/{run} for older runs.
    tests:
    - not_null
  - name: coursestructure_block_id
    description: str, block ID for a distinct piece of content in a course, referencing
      course_structure
    tests:
    - not_null
  - name: coursestructure_block_category
    description: str, category/type of the block, referencing course_structure.
    tests:
    - not_null
  - name: studentmodule_state_data
    description: json, JSON object indicating the user’s last known state in the course.
      It may contain any attributes for different module types - course, chapter,
      sequential, etc.
    tests:
    - not_null
  - name: studentmodule_problem_grade
    description: float, floating point value indicating the total unweighted grade
      for this problem that the learner has scored. e.g. how many responses they got
      right within the problem. This data is also available in courseactivity_problemcheck
  - name: studentmodule_problem_max_grade
    description: float, floating point value indicating the total possible unweighted
      grade for this problem, or basically the number of responses that are in this
      problem. This data is also available in courseactivity_problemcheck
  - name: studentmodule_created_on
    description: timestamp, datetime when this row was created, which is typically
      when the learner first accesses this piece of content.
    tests:
    - not_null
  - name: studentmodule_updated_on
    description: timestamp, datetime when this row was last updated. A change in this
      field implies that there was a state change.
    tests:
    - not_null
  tests:
  - dbt_expectations.expect_compound_columns_to_be_unique:
      column_list: ["user_id", "courserun_readable_id", "coursestructure_block_id"]

- name: stg__edxorg__s3__course_video
  description: edX.org course video metadata
  columns:
  - name: courserun_readable_id
    description: str, edX Course ID formatted as course-v1:{org}+{course code}+{run_tag}
    tests:
    - not_null
  - name: courserun_old_readable_id
    description: str, edX Course ID formatted as {org}/{course number}/{run}, which
      is used for joining because it matches the format in other edX.org tables.
    tests:
    - not_null
  - name: video_block_id
    description: str, hash code or module name for the video. This value is the last
      part of video block ID string, e.g., block-v1:{org}+{course}+{run}type@{block
      type}+block@{module name or hash code}.
    tests:
    - not_null
  - name: video_edx_id
    description: str, video ID on the edX platform. This value is the same as the
      edx_video_id field in the coursestructure_block_metadata JSON for the video
      block.
  - name: video_duration
    description: float, the length of the video, in seconds. May be 0.0.
    tests:
    - not_null
  tests:
  - dbt_expectations.expect_compound_columns_to_be_unique:
      column_list: ["courserun_readable_id", "video_block_id"]

- name: stg__edxorg__s3__programs
  description: this table includes all the programs running on edX.org
  columns:
  - name: program_uuid
    description: str, UUID of the program on edX.org.
    tests:
    - not_null
    - unique
  - name: program_title
    description: str, title of the program on edX.org
    tests:
    - not_null
  - name: program_subtitle
    description: str, subtitle of the program on edX.org
  - name: program_type
    description: str, type of the program. e.g., MicroMasters, XSeries
  - name: program_status
    description: str, status of the program. Possible values are active, retired,
      unpublished or deleted
    tests:
    - not_null
  - name: program_organization
    description: str, name of the organization that authored the program. e.g., MITx
      , HarvardX
  - name: program_updated_on
    description: str, timestamp when the data was last modified

- name: stg__edxorg__s3__program_courses
  description: this table includes all the program courses running on edX.org
  columns:
  - name: program_uuid
    description: str, UUID of the program on edX.org.
    tests:
    - not_null
  - name: course_readable_id
    description: str, readable ID for the course in {org}/{course} format. e.g., MITx/15.415.1x
    tests:
    - not_null
  - name: course_title
    description: str, title of the course
    tests:
    - not_null
  - name: course_description
    description: str, short description of the course
  - name: course_type
    description: str, type of the course. e.g., audit, verified, professional
  tests:
  - dbt_expectations.expect_compound_columns_to_be_unique:
      column_list: ["program_uuid", "course_readable_id"]

- name: stg__edxorg__api__course
  description: MITx courses on edX.org, sourced from the discovery API
  columns:
  - name: course_readable_id
    description: str, unique identifier for the course in {org}+{course number} format.
      e.g., MITx+15.415.1x
    tests:
    - unique
    - not_null
  - name: course_title
    description: str, title of the course
    tests:
    - not_null
  - name: course_description
    description: str, the short description of the course and its content
  - name: course_full_description
    description: str, the long description of the course and its content.
  - name: course_level
    description: str, the course’s level of difficulty. Values can be 'high_school',
      'introductory', 'intermediate', or 'advanced'.
  - name: course_type
    description: str, audit, verified-audit, credit-verified-audit, or professional
  - name: course_organizations
    description: str, list of organizations associated with the course, e.g., MITx
  - name: course_marketing_url
    description: str, the URL for the course About page.
  - name: course_image_url
    description: str, the URL for the course image
  - name: course_topics
    description: array, the academic subjects that this course covers.
  - name: course_prerequisites_text
    description: text, any courses a learner must complete before enrolling in the
      current course
  - name: course_updated_at
    description: timestamp, the date and time the course was last modified.
    tests:
    - not_null

- name: stg__edxorg__api__courserun
  description: MITx course runs on edX.org, sourced from the discovery API
  columns:
  - name: courserun_readable_id
    description: str, unique identifier for the course run in {org}+{course number}+{run}
      format.
    tests:
    - unique
    - not_null
  - name: course_readable_id
    description: str, unique identifier for the course in {org}+{course number} format.
      e.g., MITx+15.415.1x
    tests:
    - not_null
  - name: courserun_title
    description: str, title of the course
    tests:
    - not_null
  - name: courserun_short_description
    description: str, the short description of the course and its content
  - name: courserun_full_description
    description: str, the long description of the course and its content.
  - name: courserun_image_url
    description: str, the URL for the course image
  - name: courserun_level
    description: str, the course’s level of difficulty. Values can be 'high_school',
      'introductory', 'intermediate', or 'advanced'.
  - name: courserun_is_enrollable
    description: boolean, whether the course is currently open for enrollment
  - name: courserun_marketing_url
    description: str, the URL for the course About page.
  - name: courserun_languages
    description: str, the language for this course run.
  - name: courserun_pace
    description: str, the pacing of the course. Possible values are 'self_paced' or
      'instructor_paced'.
  - name: courserun_is_self_paced
    description: boolean, indicating whether or not the course is self paced
  - name: courserun_enrollment_mode
    description: str, audit, verified, credit, or professional.
  - name: courserun_status
    description: str, the status of the course run. Possible values are 'published',
      'unpublished', or 'reviewed'
  - name: courserun_availability
    description: str, the availability of the course run. Possible values are 'Upcoming',
      'Starting Soon', 'Current' or 'Archived'
  - name: courserun_enrollment_modes
    description: array, list of the available modes for this course. The member field
      includes type, price, currency, upgrade_deadline, credit_provider and credit_hours
  - name: courserun_instructors
    description: array, list of instructors associated with the course
  - name: courserun_duration
    description: str, the number of weeks to complete the course. e.g. '4 weeks'
  - name: courserun_time_commitment
    description: str, short description indicating about the time commitments (e.g.
      '5-7 hours per week')
  - name: courserun_is_published
    description: boolean, indicating whether the course run is published and open
      for enrollment
  - name: courserun_min_weekly_hours
    description: int, the minimum number of estimated hours of effort per week.
  - name: courserun_max_weekly_hours
    description: int, the maximum number of estimated hours of effort per week.
  - name: courserun_estimated_hours
    description: int, the estimated number of hours to complete the course.
  - name: courserun_start_on
    description: timestamp, the course start date.
  - name: courserun_end_on
    description: datetime, the course end date.
  - name: courserun_enrollment_start_on
    description: timestamp, the course enrollment start date.
  - name: courserun_enrollment_end_on
    description: timestamp, the course enrollment end date.
  - name: courserun_announce_on
    description: timestamp, date and time when the course will be announced and visible.
  - name: courserun_updated_at
    description: timestamp, the date and time the course was last modified.
    tests:
    - not_null

- name: stg__edxorg__s3__course_certificate_signatory
  description: edx course certificate signatory data
  columns:
  - name: signatory_id
    description: int, ID for the certificate signatory
    tests:
    - not_null
  - name: courserun_readable_id
    description: str, course readable ID formatted in {org}+{course number}+{run}
    tests:
    - not_null
  - name: signatory_certificate_id
    description: int, ID used to identify the course certificate
    tests:
    - not_null
  - name: signatory_name
    description: str, name of the signatory
  - name: signatory_normalized_name
    description: str, normalized name of the signatory. Removes Professor, Dr., etc.
  - name: signatory_title
    description: str, title of the signatory
  - name: signatory_organization
    description: str, organization of the signatory
  - name: signature_image_url
    description: str, url of signature image file on edX platform
  tests:
  - dbt_expectations.expect_compound_columns_to_be_unique:
      column_list: ["signatory_id", "courserun_readable_id"]

- name: stg__edxorg__s3__course_policy
  description: edx course policy data
  columns:
  - name: courserun_readable_id
    description: str, course readable ID formatted in {org}+{course number}+{run}
    tests:
    - not_null
    - unique
  - name: display_coursenumber
    description: str, the course number to display to users
  - name: courserun_is_self_paced
    description: boolean, whether the course is self-paced or instructor-paced
  - name: course_advanced_module_array
    description: array, list of advanced modules indicating what custom xblocks are
      in use in a course. e.g.["lti_consumer"]
  - name: courserun_tabs_array
    description: array, metadata about additional static tabs added to the course
  - name: course_discussion_settings_object
    description: object, contains discussion (forum) configurations. Examples of member
      fields include enable_graded_units, posting_restrictions, provider, etc.
